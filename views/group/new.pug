extends ../layouts/main

block styles
  link(rel="stylesheet" href="https://unpkg.com/easymde@2.10.1/dist/easymde.min.css")
  link(rel="stylesheet" href="https://unpkg.com/bulma-quickview@2.0.0/dist/css/bulma-quickview.min.css")
  link(rel="stylesheet", href="https://cdn.jsdelivr.net/npm/@fullcalendar/core@4.3.1/main.min.css")
  link(rel="stylesheet", href="https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@4.3.0/main.min.css")
  link(rel="stylesheet", href="https://cdn.jsdelivr.net/npm/@fullcalendar/timegrid@4.3.0/main.min.css")

block content
  if isEditing
    h1.title Csoport módosítása
  else
    h1.title Új csoport felvétele
  form(id="group-form")
    .field
      label.label(for="name") Csoport neve
      .control
        input.input(type="text", name="name", id="name", placeholder="Analízis ZH1 készülés", value=`${name? name : ''}`, required, maxlength="100")
    .field
      label.label Címkék (8)
      .control
        input.input(type="tags", name="tags", id="tags", placeholder="Adj hozzá címkéket...", value=`${tags? tags : ''}`)
    .field
      label.label(for="room") Szint
      .control
        .select
          select(name="room", id="room")
            each room in ROOMS
              if roomId == room
                option(value=`${room}`, selected='selected')
                  =room
              else
                option(value=`${room}`)
                  =room
        button.button.is-secondary.ml-2(data-show="quickview", data-target="quickviewDefault", type="button") Naptár
    .field
      label.label Maximális létszám
      .control
        input.input(type="number", name="maxAttendees", placeholder="Alapértelmezetten 100", value=`${maxAttendees ? maxAttendees : ''}`, min=1, max=100)
    .field
      label.label Kezdés ideje
      .control.has-icons-left
        input.input(type="datetime", id="pickerStart", name="startDate" required)
      p.help Vizsgáld felül, jól vitted-e be az adatokat!
    .field
      label.label Befejezés ideje
      .control.has-icons-left
        input.input(type="datetime", id="pickerEnd", name="endDate" required)
      p.help Vizsgáld felül, jól vitted-e be az adatokat!
    .field
      label.label(for="desc") Leírás
      .control
        textarea.textarea(name="description", id="desc")
    .field
      .control
        input(type="checkbox", name="doNotDisturb", id="doNotDisturb", checked=(isEditing && doNotDisturb))
        label.checkbox.pl-2.is-inline(for="doNotDisturb") Nem szeretném, hogy mások csatlakozzanak
    .field
      .control
        if isEditing
          a.button.is-danger.my-3.mr-3(href=`/groups/${groupId}`)
            i.fas.fa-times
            span &nbsp;Elvetés
          button.button.is-link.my-3(type="submit", id="submitBtn", disabled)
            i.fas.fa-check
            span &nbsp;Mentés
        else
          button.button.is-link.my-3(type="submit", id="submitBtn", disabled)
            i.fas.fa-plus
            span &nbsp;Csoport létrehozása
  #quickviewDefault.quickview
    header.quickview-header
      p.title Szint foglaltsága
      span.delete(data-dismiss="quickview")
    .quickview-body
      .quickview-block.px-3.py-4
        #side-calendar

block scripts
  if start && end
    script const range = { start: !{JSON.stringify(start)}, end: !{JSON.stringify(end)} }
  if isEditing
    script const isEditing = true
    script const groupId = !{JSON.stringify(groupId)}
  if description
    script const description = !{JSON.stringify(description)}
  script(src="https://cdn.jsdelivr.net/npm/bulma-calendar@6.0.9/dist/js/bulma-calendar.min.js")
  script(src="/js/picker.js")
  script(src="https://unpkg.com/easymde@2.10.1/dist/easymde.min.js")
  script(src="/js/md-editor.js")
  script(src="https://cdn.jsdelivr.net/npm/@creativebulma/bulma-tagsinput@1.0.3/dist/js/bulma-tagsinput.min.js")
  script(src="https://unpkg.com/bulma-quickview@2.0.0/dist/js/bulma-quickview.min.js")
  script(src='https://cdn.jsdelivr.net/npm/@fullcalendar/core@4.3.0/main.js')
  script(src='https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@4.3.0/main.min.js')
  script(src='https://cdn.jsdelivr.net/npm/@fullcalendar/timegrid@4.3.0/main.min.js')
  script(src="/js/group/create.js")
  script.
    new BulmaTagsInput('#tags', {
      maxTags: 8,
      maxChars: 30,
      tagClass: 'is-info'
    })
    const quickviews = bulmaQuickview.attach()
